(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/qui-upload-audio/qui-upload-audio"],{2818:function(t,e,n){},4291:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=u(n("ea31")),o=u(n("ef4f"));function u(t){return t&&t.__esModule?t:{default:t}}var a=wx.getRecorderManager(),r={props:{audioBeforeList:{type:Array,default:function(){return[]}}},data:function(){return{fileList:[],showAdd:!0,duration:"00:00:00",durationTime:0,timer:null,recorder:new i.default,isUpLoad:!0,uploadLoading:!1}},computed:{userId:function(){return this.$store.getters["session/get"]("userId")}},watch:{audioBeforeList:{handler:function(t){this.fileList=t,this.$emit("change",this.fileList)},deep:!0,immediate:!0},durationTime:{handler:function(t){60===t&&this.stop()},deep:!0}},methods:{start:function(){var t=this,e={sampleRate:16e3,numberOfChannels:1,encodeBitRate:96e3,format:"mp3",frameSize:50};a.start(e),a.onStart((function(){t.showAdd=!1,t.chronoscope()})),a.onError((function(t){console.log(t)}))},stop:function(){var t=this;if(this.durationTime>1&&(clearInterval(this.timer),this.isUpLoad)){this.uploadLoading=!0,this.isUpLoad=!1;var e="".concat(this.userId,"_").concat(this.getCurrentTime(),".mp3");a.stop(),a.onStop((function(n){t.uploadAudio(n,e)}))}},uploadAudio:function(t,e){var n=this;o.default.start({mediaFile:t,getSignature:n.getSignature,mediaName:e,success:function(){},error:function(){n.$refs.toast.show({message:n.i18n.t("uploader.uploadFailed")})},progress:function(){},finish:function(t){n.postVideo(t.fileId,1,t.videoUrl,e)}})},getSignature:function(t){this.$store.dispatch("jv/get",["signature",{}]).then((function(e){t(e.signature)}))},showNum:function(t){return t<10?"0".concat(t):t},getCurrentTime:function(){var t=new Date,e=t.getFullYear(),n=this.showNum(t.getMonth()+1),i=this.showNum(t.getDate()),o=this.showNum(t.getHours()),u=this.showNum(t.getMinutes()),a=this.showNum(t.getSeconds());return"".concat(e).concat(n).concat(i).concat(o).concat(u).concat(a)},chronoscope:function(){var t=this;clearInterval(this.timer),this.timer=setInterval((function(){t.durationTime+=1;var e=t.showNum(parseInt(t.durationTime/60/60,10)),n=t.showNum(parseInt(t.durationTime/60,10)%60),i=t.showNum(t.durationTime%60);t.duration="".concat(e,":").concat(n,":").concat(i)}),1e3)},deleteItem:function(){this.$emit("audioDel")},blobToFile:function(t,e){return t.lastModifiedDate=new Date,t.name=e,t},audioPlayer:function(){var t=this;this.fileList.forEach((function(e){t.$refs["audio".concat(e.id)][0].audioPause()}))},postVideo:function(t,e,n,i){var o=this,u={_jv:{type:"thread/video"},file_id:t,media_url:n,type:e};this.$store.dispatch("jv/post",u).then((function(t){o.duration="00:00:00",o.durationTime=0,o.timer=null,o.uploadLoading=!1,o.isUpLoad=!0,o.fileList.push({fileName:i,url:t.media_url,id:t.file_id}),o.showAdd=!0}))}}};e.default=r},4544:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return i}));var i={quiAudioCell:function(){return n.e("components/qui-audio-cell/qui-audio-cell").then(n.bind(null,"3f49"))},quiIcon:function(){return n.e("components/qui-icon/qui-icon").then(n.bind(null,"708e"))},quiToast:function(){return n.e("components/qui-toast/qui-toast").then(n.bind(null,"91e7"))},quiLoading:function(){return n.e("components/qui-loading/qui-loading").then(n.bind(null,"9e2c"))}},o=function(){var t=this,e=t.$createElement,n=(t._self._c,t.fileList.length>0||t.showAdd?null:t.i18n.t("discuzq.post.recording")),i=t.fileList.length>0||t.showAdd?null:t.i18n.t("discuzq.post.finish"),o=t.uploadLoading?t.i18n.t("discuzq.post.uploading"):null;t.$mp.data=Object.assign({},{$root:{g0:n,g1:i,g2:o}})},u=[]},a5ec:function(t,e,n){"use strict";n.r(e);var i=n("4291"),o=n.n(i);for(var u in i)"default"!==u&&function(t){n.d(e,t,(function(){return i[t]}))}(u);e["default"]=o.a},b3b8:function(t,e,n){"use strict";n.r(e);var i=n("4544"),o=n("a5ec");for(var u in o)"default"!==u&&function(t){n.d(e,t,(function(){return o[t]}))}(u);n("c2e7");var a,r=n("f0c5"),s=Object(r["a"])(o["default"],i["b"],i["c"],!1,null,"3ee290e6",null,!1,i["a"],a);e["default"]=s.exports},c2e7:function(t,e,n){"use strict";var i=n("2818"),o=n.n(i);o.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/qui-upload-audio/qui-upload-audio-create-component',
    {
        'components/qui-upload-audio/qui-upload-audio-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("b3b8"))
        })
    },
    [['components/qui-upload-audio/qui-upload-audio-create-component']]
]);
